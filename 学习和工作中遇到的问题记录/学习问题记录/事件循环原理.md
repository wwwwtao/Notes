## 阐述 JS 事件循环

事件循环又叫消息循环（message Loop），是浏览器渲染主线程的工作方式。

在 Chrome 的源码中，它会开启一个不会结束的 for 循环，每次循环从消息队列（message queue）中取出第一个任务执行，而其他线程只需要在适合的时候将任务（回调函数包装成任务）加入到队列末尾即可。（Chrome 中目前有 76 种队列，包括微队列，交互队列，延时队列等）

过去把消息队列简单分为宏队列和微队列，这种说法已经无法满足复杂的浏览器环境，取而代之的是一种更加灵活多变的处理方式。

根据 W3C 官方的解释，每个任务有不同的类型，同类型的人物必须在同一个队列，不同的任务可以属于不用的队列。不用队列有不同的优先级，在一次事件循环中，由浏览器决定取哪一个队列的任务，但浏览器必须有一个微队列，微队列的任务一定具有最高的优先级，必须优先调度执行。

## 计时器能精准计时吗？为什么？

不行，因为：
1. 计算机硬件没有原子钟，无法做到精准计时
2. 操作系统的计时函数本身就有少量偏差，由于 js 的计时器最终调用的是操作系统的函数，也就带来了这些偏差
3. 按照 W3C 的标准，浏览器实现计时器时，如果嵌套层级超过 5 层，则会带来 4 毫秒的最小时间，这样在计时时间少于 4 毫秒时又带来了偏差
4. 受事件循环的影响，计时器的回调函数只能在主线程空闲时运行，因此又带来了偏差
